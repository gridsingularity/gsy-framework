from pendulum import datetime

current_market_slot = datetime(2023, 1, 23, 15)

TEST_AREA_RESULTS_DICT = {
    "name": "Grid",
    "uuid": "70b818d1-491f-49ca-8566-1334eec06f15",
    "parent_uuid": "",
    "type": "Area",
    "children": [
        {
            "name": "House 2",
            "uuid": "394ee848-5c6b-4fe3-a035-223a38c855d1",
            "parent_uuid": "70b818d1-491f-49ca-8566-1334eec06f15",
            "type": "Area",
            "children": [
                {
                    "name": "H2 General Load",
                    "uuid": "6a849857-7c36-45f3-8712-5702006fe3fe",
                    "parent_uuid": "394ee848-5c6b-4fe3-a035-223a38c855d1",
                    "type": "LoadHoursStrategy",
                    "children": [],
                },
                {
                    "name": "H2 PV",
                    "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    "parent_uuid": "394ee848-5c6b-4fe3-a035-223a38c855d1",
                    "type": "PVStrategy",
                    "children": [],
                },
                {
                    "name": "H2 HeatPump",
                    "uuid": "8115e950-7422-4942-b4e5-237658404d80",
                    "parent_uuid": "394ee848-5c6b-4fe3-a035-223a38c855d1",
                    "type": "HeatPumpStrategy",
                    "children": [],
                },
            ],
        }
    ],
}


TEST_CORE_STATS = {
    "70b818d1-491f-49ca-8566-1334eec06f15": {
        "bids": [],
        "offers": [],
        "trades": [],
        "market_fee": 0,
        "const_fee_rate": 0.0,
        "feed_in_tariff": 20,
        "market_maker_rate": 30,
        "area_throughput": {
            "baseline_peak_energy_import_kWh": None,
            "baseline_peak_energy_export_kWh": None,
            "import_capacity_kWh": 0.0,
            "export_capacity_kWh": 0.0,
            "imported_energy_kWh": 0.0,
            "exported_energy_kWh": 0.0,
        },
        "grid_fee_constant": 0.0,
    },
    "394ee848-5c6b-4fe3-a035-223a38c855d1": {"bids": [], "offers": [], "trades": []},
    "6a849857-7c36-45f3-8712-5702006fe3fe": {
        "bids": [],
        "offers": [],
        "trades": [
            {
                "type": "Trade",
                "match_type": "Offer",
                "id": "3db38152-b44d-4038-aba6-b66e3a263690",
                "bid": None,
                "offer": {
                    "type": "Offer",
                    "id": "61308896-5fc5-4e67-9aa6-36b19b836e7f",
                    "energy": 0.2,
                    "energy_rate": 17.71186441,
                    "price": 3.5423728820000004,
                    "original_price": 3.5423728828828827,
                    "creation_time": "2023-01-25T15:30:00",
                    "time_slot": "2023-01-25T15:00:00",
                    "seller": {
                        "name": "H2 PV",
                        "origin": "H2 PV",
                        "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                        "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    },
                },
                "residual": {
                    "type": "Offer",
                    "id": "981c0fb7-df9a-4623-878a-b6f788fea15d",
                    "energy": 0.1108,
                    "energy_rate": 17.71186444,
                    "price": 1.96247458,
                    "original_price": 1.962474577117117,
                    "creation_time": "2023-01-25T15:30:00",
                    "time_slot": "2023-01-25T15:00:00",
                    "seller": {
                        "name": "H2 PV",
                        "origin": "H2 PV",
                        "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                        "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    },
                },
                "energy": 0.2,
                "energy_rate": 17.71186441,
                "price": 3.5423728820000004,
                "buyer": {
                    "name": "H2 General Load",
                    "origin": "H2 General Load",
                    "origin_uuid": "6a849857-7c36-45f3-8712-5702006fe3fe",
                    "uuid": "6a849857-7c36-45f3-8712-5702006fe3fe",
                },
                "seller": {
                    "name": "H2 PV",
                    "origin": "H2 PV",
                    "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                },
                "fee_price": 0.0,
                "creation_time": "2023-01-25T15:30:00",
                "time_slot": "2023-01-25T15:00:00",
                "offer_bid_trade_info": None,
            }
        ],
        "market_fee": 0.0,
        "load_profile_kWh": 0.2,
        "total_energy_demanded_wh": 800.0,
        "energy_requirement_kWh": 0.0,
    },
    "9f905a1f-b1aa-461f-9290-0be561932bf4": {
        "bids": [],
        "offers": [],
        "trades": [
            {
                "type": "Trade",
                "match_type": "Offer",
                "id": "3db38152-b44d-4038-aba6-b66e3a263690",
                "bid": None,
                "offer": {
                    "type": "Offer",
                    "id": "61308896-5fc5-4e67-9aa6-36b19b836e7f",
                    "energy": 0.2,
                    "energy_rate": 17.71186441,
                    "price": 3.5423728820000004,
                    "original_price": 3.5423728828828827,
                    "creation_time": "2023-01-25T15:30:00",
                    "time_slot": "2023-01-25T15:00:00",
                    "seller": {
                        "name": "H2 PV",
                        "origin": "H2 PV",
                        "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                        "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    },
                },
                "residual": {
                    "type": "Offer",
                    "id": "981c0fb7-df9a-4623-878a-b6f788fea15d",
                    "energy": 0.1108,
                    "energy_rate": 17.71186444,
                    "price": 1.96247458,
                    "original_price": 1.962474577117117,
                    "creation_time": "2023-01-25T15:30:00",
                    "time_slot": "2023-01-25T15:00:00",
                    "seller": {
                        "name": "H2 PV",
                        "origin": "H2 PV",
                        "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                        "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    },
                },
                "energy": 0.2,
                "energy_rate": 17.71186441,
                "price": 3.5423728820000004,
                "buyer": {
                    "name": "H2 General Load",
                    "origin": "H2 General Load",
                    "origin_uuid": "6a849857-7c36-45f3-8712-5702006fe3fe",
                    "uuid": "6a849857-7c36-45f3-8712-5702006fe3fe",
                },
                "seller": {
                    "name": "H2 PV",
                    "origin": "H2 PV",
                    "origin_uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                    "uuid": "9f905a1f-b1aa-461f-9290-0be561932bf4",
                },
                "fee_price": 0.0,
                "creation_time": "2023-01-25T15:30:00",
                "time_slot": "2023-01-25T15:00:00",
                "offer_bid_trade_info": None,
            }
        ],
        "market_fee": 0.0,
        "pv_production_kWh": 0.3108,
        "available_energy_kWh": 0.11080000000000001,
    },
    "8115e950-7422-4942-b4e5-237658404d80": {
        "bids": [],
        "offers": [],
        "trades": [],
        "market_fee": 0.0,
        "storage_temp_C": 65,
        "energy_consumption_kWh": 10,
        "available_energy_kWh": 0.11080000000000001,
    },
}

TEST_COEFFICIENT_AREA_RESULTS = [
    {
        "results": {
            "7b359ad5-a9b4-47c6-a147-85a7ee8e5dd1": {
                "bought_from_community": 0.0,
                "bought_from_grid": 37.670700000000004,
                "consumption_kWh": 46.465,
                "production_kWh": 8.7943,
                "self_consumed_energy_kWh": 8.7943,
                "energy_surplus_kWh": 0.0,
                "energy_need_kWh": 37.670700000000004,
                "allocated_community_energy_kWh": 5.50197,
                "energy_bought_from_community_kWh": 5.50197,
                "energy_sold_to_grid_kWh": 0.0,
            },
            "cf1f5882-ec59-4506-8801-e3b5f7aaf408": {
                "bought_from_community": 0.0,
                "bought_from_grid": 0.0,
                "consumption_kWh": 24.129,
                "production_kWh": 79.1487,
                "self_consumed_energy_kWh": 24.129,
                "energy_surplus_kWh": 55.0197,
                "energy_need_kWh": 0.0,
                "allocated_community_energy_kWh": 49.51773,
                "energy_bought_from_community_kWh": 0.0,
                "energy_sold_to_grid_kWh": 55.0197,
            },
            "1521b3f4-c655-4ab8-b8b7-94f14f7279a0": {
                "bought_from_community": 0.0,
                "bought_from_grid": 37.670700000000004,
                "consumption_kWh": 70.59400000000001,
                "production_kWh": 87.94300000000001,
                "self_consumed_energy_kWh": 32.9233,
                "energy_surplus_kWh": 55.0197,
                "energy_need_kWh": 37.670700000000004,
                "energy_bought_from_community_kWh": 5.50197,
                "energy_sold_to_grid_kWh": 55.0197,
            },
        },
        "current_market": "2021-08-01T23:30",
    },
    {
        "results": {
            "7b359ad5-a9b4-47c6-a147-85a7ee8e5dd1": {
                "bought_from_community": 0.0,
                "bought_from_grid": 37.670700000000004,
                "consumption_kWh": 46.465,
                "production_kWh": 8.7943,
                "self_consumed_energy_kWh": 8.7943,
                "energy_surplus_kWh": 0.0,
                "energy_need_kWh": 37.670700000000004,
                "allocated_community_energy_kWh": 5.50197,
                "energy_bought_from_community_kWh": 5.50197,
                "energy_sold_to_grid_kWh": 0.0,
            },
            "cf1f5882-ec59-4506-8801-e3b5f7aaf408": {
                "bought_from_community": 0.0,
                "bought_from_grid": 0.0,
                "consumption_kWh": 24.129,
                "production_kWh": 79.1487,
                "self_consumed_energy_kWh": 24.129,
                "energy_surplus_kWh": 55.0197,
                "energy_need_kWh": 0.0,
                "allocated_community_energy_kWh": 49.51773,
                "energy_bought_from_community_kWh": 0.0,
                "energy_sold_to_grid_kWh": 55.0197,
            },
            "1521b3f4-c655-4ab8-b8b7-94f14f7279a0": {
                "bought_from_community": 0.0,
                "bought_from_grid": 37.670700000000004,
                "consumption_kWh": 70.59400000000001,
                "production_kWh": 87.94300000000001,
                "self_consumed_energy_kWh": 32.9233,
                "energy_surplus_kWh": 55.0197,
                "energy_need_kWh": 37.670700000000004,
                "energy_bought_from_community_kWh": 5.50197,
                "energy_sold_to_grid_kWh": 55.0197,
            },
        },
        "current_market": "2021-08-01T23:45",
    },
]
